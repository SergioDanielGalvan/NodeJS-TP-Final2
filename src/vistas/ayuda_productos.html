<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayuda - Gesti√≥n de Productos</title>
    <link rel="stylesheet" href="css/ayuda.css">
    <style>
        /* Sobrescribir variables para el tema productos */
        .productos {
            --primary-color: #27ae60;
            --secondary-color: #2ecc71;
            --accent-color: #e74c3c;
            --warning-color: #f39c12;
            --info-color: #3498db;
            --success-color: #27ae60;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --danger-color: #e74c3c;
        }
    </style>
</head>
<body class="productos">
    <div class="container">
        <header class="header">
            <h1>üõçÔ∏è Ayuda - Gesti√≥n de Productos</h1>
            <p>Documentaci√≥n completa de la API para gesti√≥n de productos del cat√°logo</p>
            <p><strong>Base URL:</strong> https://nodejs-tp-final2-4xldcgcji-sergio-galvans-projects-870a1523.vercel.app/api</p>
            <div class="badge">üìä Stock Management | üí∞ Pricing | üì¶ Categories</div>
        </header>
        
        <nav class="nav">
            <ul>
                <li><a href="#introduccion" class="active">üìö Introducci√≥n</a></li>
                <li><a href="#estructura">üèóÔ∏è Estructura</a></li>
                <li><a href="#endpoints-publicos">üåê P√∫blicos</a></li>
                <li><a href="#endpoints-privados">üîí Privados</a></li>
                <li><a href="#stock-precios">üìà Stock/Precios</a></li>
                <li><a href="#ejemplos">üí° Ejemplos</a></li>
            </ul>
        </nav>
        
        <main class="content">
            <section id="introduccion" class="section">
                <h2>Introducci√≥n al Sistema de Productos</h2>
                <p>Esta API proporciona acceso completo a la gesti√≥n del cat√°logo de productos. Incluye funcionalidades para consulta, creaci√≥n, actualizaci√≥n y eliminaci√≥n de productos, con control de stock y precios.</p>
                
                <div class="note">
                    <p><strong>üí° Informaci√≥n importante:</strong> Los endpoints est√°n divididos en p√∫blicos (acceso libre) y privados (requieren autenticaci√≥n). Algunas operaciones solo est√°n disponibles para administradores.</p>
                </div>
                
                <div class="quick-actions">
                    <div class="action-card">
                        <div class="action-icon">üìã</div>
                        <h3>Listado Completo</h3>
                        <p>Consulta todos los productos disponibles</p>
                        <code>GET /productos</code>
                    </div>
                    
                    <div class="action-card">
                        <div class="action-icon">üîç</div>
                        <h3>B√∫squeda Avanzada</h3>
                        <p>Filtra por ID, nombre o categor√≠a</p>
                        <code>GET /productos/nombre/:nombre</code>
                    </div>
                    
                    <div class="action-card">
                        <div class="action-icon">‚ûï</div>
                        <h3>Nuevo Producto</h3>
                        <p>Crea nuevos productos en el cat√°logo</p>
                        <code>POST /productos</code>
                    </div>
                </div>
            </section>
            
            <section id="estructura" class="section">
                <h2>Estructura de un Producto</h2>
                <p>Los productos siguen una estructura JSON espec√≠fica con los siguientes campos:</p>
                
                <div class="code-block">
{
    "idproducto": 9,
    "nombre": "Micr√≥fono Omnidireccional JBL Bluetooth",
    "categorias": ["Tecnolog√≠a", "Audio", "Accesorios"],
    "precio": 123400,
    "stock": 23,
    "operadoralta": 1,
    "operadormodificacion": 0,
    "fechaalta": "2025-12-08T21:18:30-03:00",
    "fechamodificacion": "2025-12-10T16:19:01-03:00"
}
                </div>
                
                <div class="param-section">
                    <h3>Descripci√≥n de Campos</h3>
                    <table class="param-table">
                        <tr>
                            <th>Campo</th>
                            <th>Tipo</th>
                            <th>Descripci√≥n</th>
                            <th>Ejemplo</th>
                        </tr>
                        <tr>
                            <td><strong>idproducto</strong></td>
                            <td><span class="type-badge type-number">number</span></td>
                            <td>Identificador √∫nico del producto</td>
                            <td><code>9</code></td>
                        </tr>
                        <tr>
                            <td><strong>nombre</strong></td>
                            <td><span class="type-badge type-string">string</span></td>
                            <td>Nombre del producto (m√°x. 255 chars)</td>
                            <td><code>"Micr√≥fono JBL"</code></td>
                        </tr>
                        <tr>
                            <td><strong>categorias</strong></td>
                            <td><span class="type-badge type-array">array[string]</span></td>
                            <td>Categor√≠as del producto</td>
                            <td><code>["Tecnolog√≠a", "Audio"]</code></td>
                        </tr>
                        <tr>
                            <td><strong>precio</strong></td>
                            <td><span class="type-badge type-number">number</span></td>
                            <td>Precio en centavos (sin decimales)</td>
                            <td><code>123400</code> = $1,234.00</td>
                        </tr>
                        <tr>
                            <td><strong>stock</strong></td>
                            <td><span class="type-badge type-number">number</span></td>
                            <td>Cantidad disponible (‚â• 0)</td>
                            <td><code>23</code></td>
                        </tr>
                        <tr>
                            <td><strong>operadoralta</strong></td>
                            <td><span class="type-badge type-number">number</span></td>
                            <td>ID del operador que cre√≥ el registro</td>
                            <td><code>1</code> (Admin)</td>
                        </tr>
                        <tr>
                            <td><strong>fechaalta</strong></td>
                            <td><span class="type-badge type-timestamp">timestamp</span></td>
                            <td>Fecha de creaci√≥n (autom√°tica)</td>
                            <td><code>2025-12-08T21:18:30-03:00</code></td>
                        </tr>
                    </table>
                </div>
                
                <div class="warning">
                    <p><strong>‚ö†Ô∏è Nota sobre precios:</strong> Los precios se almacenan en <strong>centavos</strong> (o la unidad m√≠nima de tu moneda). Para mostrar al usuario, dividir por 100.</p>
                    <p><code>123400 ‚Üí $1,234.00</code></p>
                </div>
            </section>
            
            <section id="endpoints-publicos" class="section">
                <h2>Endpoints P√∫blicos</h2>
                <p>Estos endpoints est√°n disponibles sin necesidad de autenticaci√≥n.</p>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-title">Obtener todos los productos</span>
                        <span class="access-badge public">P√∫blico</span>
                    </div>
                    <div class="endpoint-url">/api/productos</div>
                    <p class="endpoint-description">Retorna una lista paginada de todos los productos disponibles en el cat√°logo.</p>
                    
                    <h4>Par√°metros Query (opcionales):</h4>
                    <table class="param-table">
                        <tr>
                            <th>Par√°metro</th>
                            <th>Tipo</th>
                            <th>Descripci√≥n</th>
                            <th>Valor por defecto</th>
                        </tr>
                        <tr>
                            <td>page</td>
                            <td>number</td>
                            <td>N√∫mero de p√°gina</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>limit</td>
                            <td>number</td>
                            <td>Productos por p√°gina</td>
                            <td>20</td>
                        </tr>
                        <tr>
                            <td>sort</td>
                            <td>string</td>
                            <td>Campo para ordenar (nombre, precio, fechaaalta)</td>
                            <td>fechaalta</td>
                        </tr>
                    </table>
                    
                    <h4>Response (200):</h4>
                    <div class="code-block">
{
    "success": true,
    "count": 150,
    "page": 1,
    "totalPages": 8,
    "data": [
        {
            "idproducto": 1,
            "nombre": "Producto Ejemplo",
            "categorias": ["Categor√≠a 1"],
            "precio": 9999,
            "stock": 10
        }
    ]
}
                    </div>
                </div>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-title">Obtener producto por ID</span>
                        <span class="access-badge public">P√∫blico</span>
                    </div>
                    <div class="endpoint-url">/api/productos/:id</div>
                    <p class="endpoint-description">Retorna los detalles completos de un producto espec√≠fico por su ID num√©rico.</p>
                    
                    <h4>Par√°metros de Ruta:</h4>
                    <table class="param-table">
                        <tr>
                            <th>Par√°metro</th>
                            <th>Tipo</th>
                            <th>Descripci√≥n</th>
                        </tr>
                        <tr>
                            <td>id</td>
                            <td>number</td>
                            <td>ID num√©rico del producto</td>
                        </tr>
                    </table>
                    
                    <h4>Ejemplo:</h4>
                    <div class="code-block">
GET /api/productos/9

Response:
{
    "success": true,
    "data": {
        "idproducto": 9,
        "nombre": "Micr√≥fono Omnidireccional JBL Bluetooth",
        "categorias": ["Tecnolog√≠a", "Audio", "Accesorios"],
        "precio": 123400,
        "stock": 23,
        "operadoralta": 1,
        "fechaalta": "2025-12-08T21:18:30-03:00"
    }
}
                    </div>
                </div>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-title">Buscar producto por nombre</span>
                        <span class="access-badge public">P√∫blico</span>
                    </div>
                    <div class="endpoint-url">/api/productos/nombre/:nombre</div>
                    <p class="endpoint-description">B√∫squeda de productos por nombre (b√∫squeda parcial, case-insensitive).</p>
                    
                    <div class="note">
                        <p><strong>üîé Nota:</strong> Esta b√∫squeda es parcial. Ejemplo: buscar "micr√≥fono" encontrar√° todos los productos que contengan esa palabra en su nombre.</p>
                    </div>
                </div>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-title">Filtrar productos por categor√≠a</span>
                        <span class="access-badge public">P√∫blico</span>
                    </div>
                    <div class="endpoint-url">/api/productos/categoria?categoria=:categoria</div>
                    <p class="endpoint-description">Filtra productos por categor√≠a espec√≠fica usando par√°metros query.</p>
                    
                    <h4>Ejemplo:</h4>
                    <div class="code-block">
GET /api/productos/categoria?categoria=Tecnolog√≠a

GET /api/productos/categoria?categoria=Audio&categoria=Accesorios
                    </div>
                </div>
            </section>
            
            <section id="endpoints-privados" class="section">
                <h2>Endpoints Privados (Requieren Autenticaci√≥n)</h2>
                <div class="warning">
                    <p><strong>üîê Requerido:</strong> Todos estos endpoints requieren el header <code>Authorization: Bearer {token_jwt}</code></p>
                    <p>Algunas operaciones adicionales requieren permisos de administrador.</p>
                </div>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-get">GET</span>
                        <span class="endpoint-title">Obtener productos con informaci√≥n de stock</span>
                        <span class="access-badge private">Privado</span>
                    </div>
                    <div class="endpoint-url">/api/productos/stock</div>
                    <p class="endpoint-description">Retorna productos incluyendo informaci√≥n detallada de stock (solo para usuarios autenticados).</p>
                    
                    <div class="note">
                        <p><strong>üìä Diferencia con endpoint p√∫blico:</strong> Este endpoint incluye campos adicionales como <code>stock</code> que no se muestran en los endpoints p√∫blicos por razones de seguridad comercial.</p>
                    </div>
                </div>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-post">POST</span>
                        <span class="endpoint-title">Crear nuevo producto</span>
                        <span class="access-badge private">Privado</span>
                    </div>
                    <div class="endpoint-url">/api/productos</div>
                    
                    <h4>Body Request (JSON):</h4>
                    <div class="code-block">
{
    "nombre": "Nuevo Producto",
    "categorias": ["Electr√≥nica", "Novedades"],
    "precio": 49999,
    "stock": 50
}
                    </div>
                    
                    <h4>Campos obligatorios:</h4>
                    <ul style="margin-left: 25px; margin-top: 10px;">
                        <li><code>nombre</code> - String, m√°ximo 255 caracteres</li>
                        <li><code>categorias</code> - Array de strings</li>
                        <li><code>precio</code> - N√∫mero entero positivo</li>
                        <li><code>stock</code> - N√∫mero entero ‚â• 0</li>
                    </ul>
                    
                    <h4>Response (201):</h4>
                    <div class="code-block">
{
    "success": true,
    "message": "Producto creado exitosamente",
    "data": {
        "idproducto": 25,
        "nombre": "Nuevo Producto",
        "categorias": ["Electr√≥nica", "Novedades"],
        "precio": 49999,
        "stock": 50,
        "operadoralta": 1,
        "fechaalta": "2025-12-15T10:30:00-03:00"
    }
}
                    </div>
                </div>
            </section>
            
            <section id="stock-precios" class="section">
                <h2>Gesti√≥n de Stock y Precios</h2>
                <p>Endpoints especializados para la gesti√≥n de inventario y precios.</p>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-put">PUT</span>
                        <span class="endpoint-title">Actualizar stock de producto</span>
                        <span class="access-badge private">Privado</span>
                    </div>
                    <div class="endpoint-url">/api/productos/stock/:id</div>
                    <p class="endpoint-description">Actualiza el stock disponible de un producto espec√≠fico.</p>
                    
                    <h4>Body Request (JSON):</h4>
                    <div class="code-block">
{
    "stock": 45,
    "operadormodificacion": 1
}
                    </div>
                    
                    <h4>Use Cases:</h4>
                    <ul style="margin-left: 25px;">
                        <li>Ajuste de inventario f√≠sico</li>
                        <li>Actualizaci√≥n despu√©s de ventas</li>
                        <li>Correcci√≥n de errores de stock</li>
                    </ul>
                </div>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-put">PUT</span>
                        <span class="endpoint-title">Actualizar precio de producto</span>
                        <span class="access-badge private">Privado</span>
                    </div>
                    <div class="endpoint-url">/api/productos/precio/:id</div>
                    <p class="endpoint-description">Modifica el precio de un producto existente.</p>
                    
                    <div class="warning">
                        <p><strong>üí∞ Consideraciones:</strong> Los cambios de precio pueden afectar ventas en proceso. Considerar implementar validaciones adicionales.</p>
                    </div>
                    
                    <h4>Body Request (JSON):</h4>
                    <div class="code-block">
{
    "precio": 109999,
    "operadormodificacion": 1
}
                    </div>
                </div>
                
                <div class="endpoint-card">
                    <div class="endpoint-header">
                        <span class="endpoint-method method-delete">DELETE</span>
                        <span class="endpoint-title">Eliminar producto</span>
                        <span class="access-badge admin">Solo Admin</span>
                    </div>
                    <div class="endpoint-url">/api/productos/:id</div>
                    <p class="endpoint-description">Elimina permanentemente un producto del cat√°logo.</p>
                    
                    <div class="warning">
                        <p><strong>‚ö†Ô∏è ¬°Atenci√≥n! Esta acci√≥n no se puede deshacer.</strong> Considerar implementar borrado l√≥gico (soft delete) en futuras versiones.</p>
                    </div>
                    
                    <h4>Response (200):</h4>
                    <div class="code-block">
{
    "success": true,
    "message": "Producto eliminado exitosamente",
    "deletedId": 9
}
                    </div>
                </div>
            </section>
            
            <section id="ejemplos" class="section">
                <h2>Ejemplos Pr√°cticos</h2>
                
                <h3>Ejemplo 1: Flujo completo de gesti√≥n de productos</h3>
                <div class="code-block">
// 1. Login para obtener token
POST /auth/login
{
    "email": "operador@empresa.com",
    "password": "password123"
}

// Response: { "token": "eyJhbGciOiJIUzI1NiIs..." }

// 2. Crear nuevo producto (con token)
POST /api/productos
Headers: { "Authorization": "Bearer eyJhbGciOiJIUzI1NiIs..." }
{
    "nombre": "Auriculares Inal√°mbricos Premium",
    "categorias": ["Audio", "Tecnolog√≠a", "Inal√°mbrico"],
    "precio": 29999,
    "stock": 100
}

// 3. Consultar productos con stock (privado)
GET /api/productos/stock
Headers: { "Authorization": "Bearer eyJhbGciOiJIUzI1NiIs..." }

// 4. Actualizar stock despu√©s de venta
PUT /api/productos/stock/25
Headers: { "Authorization": "Bearer eyJhbGciOiJIUzI1NiIs..." }
{
    "stock": 85,
    "operadormodificacion": 1
}
                </div>
                
                <h3>Ejemplo 2: Script Python para importar productos</h3>
                <div class="code-block">
import requests
import json

BASE_URL = "https://tudominio.com/api"
TOKEN = "tu_token_jwt_aqui"

def crear_producto(producto_data):
    headers = {
        "Authorization": f"Bearer {TOKEN}",
        "Content-Type": "application/json"
    }
    
    response = requests.post(
        f"{BASE_URL}/productos",
        headers=headers,
        json=producto_data
    )
    
    if response.status_code == 201:
        print(f"‚úÖ Producto creado: {producto_data['nombre']}")
        return response.json()
    else:
        print(f"‚ùå Error: {response.status_code}")
        print(response.json())
        return None

# Ejemplo de uso
productos_nuevos = [
    {
        "nombre": "Teclado Mec√°nico RGB",
        "categorias": ["Tecnolog√≠a", "Perif√©ricos"],
        "precio": 8999,
        "stock": 30
    },
    {
        "nombre": "Mouse Inal√°mbrico",
        "categorias": ["Tecnolog√≠a", "Perif√©ricos"],
        "precio": 4999,
        "stock": 50
    }
]

for producto in productos_nuevos:
    crear_producto(producto)
                </div>
                
                <h3>Ejemplo 3: Consultas comunes desde frontend</h3>
                <div class="code-block">
// JavaScript/React - Consultar productos por categor√≠a
async function getProductosByCategory(categoria) {
    try {
        const response = await fetch(`/api/productos/categoria?categoria=${categoria}`);
        const data = await response.json();
        
        if (data.success) {
            return data.data.map(producto => ({
                ...producto,
                precioFormateado: `$${(producto.precio / 100).toFixed(2)}`
            }));
        }
        return [];
    } catch (error) {
        console.error('Error fetching products:', error);
        return [];
    }
}

// Buscar productos por nombre
async function searchProducts(query) {
    if (query.length < 2) return [];
    
    const response = await fetch(`/api/productos/nombre/${encodeURIComponent(query)}`);
    const data = await response.json();
    
    return data.success ? data.data : [];
}

// Formatear precio para mostrar
function formatPrice(priceInCents) {
    return new Intl.NumberFormat('es-AR', {
        style: 'currency',
        currency: 'ARS'
    }).format(priceInCents / 100);
}
                </div>
            </section>
        </main>
        
        <footer class="footer">
            <p>üìñ Documentaci√≥n de la API - Sistema de Gesti√≥n de Productos</p>
            <p>¬© 2025 - Versi√≥n 1.2.0 | √öltima actualizaci√≥n: Diciembre 2025</p>
            <div class="footer-links">
                <a href="ayuda.html">üè† Ayuda General</a>
                <a href="ayuda_operadores.html">üë• Gesti√≥n de Operadores</a>
                <a href="help.html">üåê English Version</a>
                <a href="#">üìß Soporte T√©cnico</a>
            </div>
            <p style="margin-top: 20px; font-size: 0.9rem; opacity: 0.8;">
                API desarrollada con Node.js, Express y Firebase Firestore
            </p>
        </footer>
    </div>
    
    <script>
        // Smooth scroll para navegaci√≥n
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if(targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if(targetElement) {
                    window.scrollTo({
                        top: targetElement.offsetTop - 100,
                        behavior: 'smooth'
                    });
                    
                    // Actualizar navegaci√≥n activa
                    document.querySelectorAll('.nav a').forEach(a => {
                        a.classList.remove('active');
                    });
                    this.classList.add('active');
                }
            });
        });
        
        // Resaltado de sintaxis JSON mejorado
        document.addEventListener('DOMContentLoaded', function() {
            const codeBlocks = document.querySelectorAll('.code-block');
            const syntaxColors = {
                property: '#ff79c6',
                string: '#8be9fd',
                number: '#bd93f9',
                boolean: '#bd93f9',
                null: '#ff5555',
                punctuation: '#f8f8f2',
                key: '#ffb86c'
            };
            
            codeBlocks.forEach(block => {
                let code = block.textContent;
                
                // Mejor resaltado para JSON
                code = code
                    .replace(/("(\\"|[^"])*"):/g, `<span style="color: ${syntaxColors.property}">$1</span>:`)
                    .replace(/: ("(\\"|[^"])*")/g, `: <span style="color: ${syntaxColors.string}">$1</span>`)
                    .replace(/: ([\d]+)/g, `: <span style="color: ${syntaxColors.number}">$1</span>`)
                    .replace(/: (true|false|null)/g, `: <span style="color: ${syntaxColors.boolean}">$1</span>`)
                    .replace(/([{}[\],])/g, `<span style="color: ${syntaxColors.punctuation}">$1</span>`);
                
                block.innerHTML = code;
            });
            
            // Actualizar navegaci√≥n activa al hacer scroll
            window.addEventListener('scroll', function() {
                const sections = document.querySelectorAll('.section');
                const navLinks = document.querySelectorAll('.nav a');
                
                let currentSection = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - 150;
                    const sectionHeight = section.clientHeight;
                    
                    if(window.scrollY >= sectionTop && 
                       window.scrollY < sectionTop + sectionHeight) {
                        currentSection = '#' + section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if(link.getAttribute('href') === currentSection) {
                        link.classList.add('active');
                    }
                });
            });
        });
    </script>
</body>
</html>